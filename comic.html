<!DOCTYPE html>
<html lang="en">
<html>
<head>

    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="stylesheet" href="./css/style.css">

    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
        }

        .comic-container {
            display: grid;
            grid-template-rows: auto auto auto;
            gap: 10px;
            text-align: center;
        }

        .comic-image {
            max-width: 100%;
            height: auto;
        }

        nav {
            height: 100%;
        }
    </style>



</head>

<body>

<nav>
    <button class="button" role="button" onclick="location.href='index.html'">Main Page</button>
</nav>

<div class="comic-container">
    <img class="comic-image" src="/images/Spinner-1s-200px.gif" alt="">
    <h1 class="comic-title"></h1>
    <p class="comic-date"></p>
</div>

<script>
    const email = 'd.prostiruk@innopolis.university';
    const fetchId = (email) => {
        return fetch(`https://fwd.innopolis.university/api/hw2?email=${email}`)
            .then(response => response.text())
            .then(data => {
                return data;
            });

        console.log(data);
    };

    const fetchInfo = (comicId) =>  {
        return fetch(`https://fwd.innopolis.university/api/comic?id=${comicId}`)
            .then(response => response.json())
            .then(comicInfo => {
                return comicInfo;
            });
        console.log(comicInfo);
    };

    const handleError = (error) => {
        console.error(error);
    };

    const displayComic = (comicInfo) => {
        const comicImage = document.querySelector('.comic-image');
        const comicTitle = document.querySelector('.comic-title');
        const comicDate = document.querySelector('.comic-date');

        comicImage.src = comicInfo.img;
        comicImage.alt = comicInfo.alt;
        comicTitle.textContent = comicInfo.safe_title;
        comicDate.textContent = new Date(comicInfo.year, comicInfo.month - 1, comicInfo.day).toLocaleDateString();
    }

    fetchId(email)
        .then(comicId => fetchInfo(comicId))
        .then(comicInfo => displayComic(comicInfo))
        .catch(error => handleError(error));
</script>
</body>
</html>
